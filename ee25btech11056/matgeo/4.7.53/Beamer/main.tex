\documentclass{beamer}
\mode<presentation>
\usepackage{amsmath,amssymb,mathtools}
\usepackage{textcomp}
\usepackage{gensymb}
\usepackage{adjustbox}
\usepackage{subcaption}
\usepackage{enumitem}
\usepackage{multicol}
\usepackage{listings}
\usepackage{url}
\usepackage{graphicx} % <-- needed for images
\def\UrlBreaks{\do\/\do-}

\usetheme{Boadilla}
\usecolortheme{lily}
\setbeamertemplate{footline}{
  \leavevmode%
  \hbox{%
  \begin{beamercolorbox}[wd=\paperwidth,ht=2ex,dp=1ex,right]{author in head/foot}%
    \insertframenumber{} / \inserttotalframenumber\hspace*{2ex}
  \end{beamercolorbox}}%
  \vskip0pt%
}
\setbeamertemplate{navigation symbols}{}

\lstset{
  frame=single,
  breaklines=true,
  columns=fullflexible,
  basicstyle=\ttfamily\tiny   % tiny font so code fits
}

\numberwithin{equation}{section}

% ---- your macros ----
\providecommand{\nCr}[2]{\,^{#1}C_{#2}}
\providecommand{\nPr}[2]{\,^{#1}P_{#2}}
\providecommand{\mbf}{\mathbf}
\providecommand{\pr}[1]{\ensuremath{\Pr\left(#1\right)}}
\providecommand{\qfunc}[1]{\ensuremath{Q\left(#1\right)}}
\providecommand{\sbrak}[1]{\ensuremath{{}\left[#1\right]}}
\providecommand{\lsbrak}[1]{\ensuremath{{}\left[#1\right.}}
\providecommand{\rsbrak}[1]{\ensuremath{\left.#1\right]}}
\providecommand{\brak}[1]{\ensuremath{\left(#1\right)}}
\providecommand{\lbrak}[1]{\ensuremath{\left(#1\right.}}
\providecommand{\rbrak}[1]{\ensuremath{\left.#1\right)}}
\providecommand{\cbrak}[1]{\ensuremath{\left\{#1\right\}}}
\providecommand{\lcbrak}[1]{\ensuremath{\left\{#1\right.}}
\providecommand{\rcbrak}[1]{\ensuremath{\left.#1\right\}}}
\theoremstyle{remark}
\newtheorem{rem}{Remark}
\newcommand{\sgn}{\mathop{\mathrm{sgn}}}
\providecommand{\abs}[1]{\left\vert#1\right\vert}
\providecommand{\res}[1]{\Res\displaylimits_{#1}}
\providecommand{\norm}[1]{\lVert#1\rVert}
\providecommand{\mtx}[1]{\mathbf{#1}}
\providecommand{\mean}[1]{E\left[ #1 \right]}
\providecommand{\fourier}{\overset{\mathcal{F}}{ \rightleftharpoons}}
\providecommand{\system}{\overset{\mathcal{H}}{ \longleftrightarrow}}
\providecommand{\dec}[2]{\ensuremath{\overset{#1}{\underset{#2}{\gtrless}}}}
\newcommand{\myvec}[1]{\ensuremath{\begin{pmatrix}#1\end{pmatrix}}}
\newcommand{\mydet}[1]{\ensuremath{\begin{vmatrix}#1\end{vmatrix}}}
\let\vec\mathbf
% ---------------------

\title{Matgeo Presentation - Problem 4.7.53}
\author{ee25btech11056 - Suraj.N}

\begin{document}

\begin{frame}
  \titlepage
\end{frame}

\begin{frame}{Problem Statement}

If $\vec{O}$ is the origin and $\vec{P}=\myvec{1\\2\\-3}$, then find the equation of the plane passing through $\vec{P}$ and perpendicular to $OP$.
 
\end{frame}

\begin{frame}{Data}

\begin{table}[h!]
  \centering
  \input{tables/table.tex}
  \caption*{Table : Plane}
  \label{4.7.53}
\end{table}

\end{frame}

\begin{frame}{Solution}

The normal vector to the plane is
\begin{align}
\vec{n} &= \vec{P}-\vec{O} = \myvec{1\\2\\-3}
\end{align}

The plane equation is written in the form
\begin{align}
\vec{n}^\top \vec{x} &= \vec{n}^\top \vec{h}
\end{align}
where $\vec{h}$ is a point on the plane. Here $\vec{h}=\vec{P}$

\begin{align}
\vec{n}^\top \vec{x} &= \myvec{1 & 2 & -3}\vec{P} \\
\vec{n}^\top \vec{x} &= \myvec{1 & 2 & -3}\myvec{1\\2\\-3}
\end{align}

\end{frame}

\begin{frame}

Hence, the equation of the plane is
\begin{align}
\vec{n}^\top \vec{x} &= 14 \\
\myvec{1 & 2 & -3}\vec{x} &= 14
\end{align}

\end{frame}

\begin{frame}{Plot}

\begin{figure}[h!]
  \centering
  \includegraphics[width=0.8\columnwidth]{figs/plane.png} 
   \caption*{Fig : Plane}
  \label{Fig1}
\end{figure}

\end{frame}

\section*{Appendix: Code}

% C program
\begin{frame}[fragile]{C Code: points.c}
\begin{lstlisting}[language=C]

#include <stdio.h>
#include <stdlib.h>

double *normal(double p[]) {

  double o[3] = {0, 0, 0};

  double *n = malloc(3 * sizeof(double));

  if (n == NULL)
    return NULL;

  n[0] = p[0] - o[0];
  n[1] = p[1] - o[1];
  n[2] = p[2] - o[2];

  return n;
}

\end{lstlisting}
\end{frame}

% Python calling C
\begin{frame}[fragile]{Python: call\_c.py}
\begin{lstlisting}[language=Python]

import ctypes
import sys
import os
import numpy as np
import matplotlib.pyplot as plt

#for generating figure in figs folder
figs_folder= os.path.join("..","figs")

#loading shared object 
lib = ctypes.CDLL("./points.so")

#tell ctypes about the function signature
lib.normal.restype = ctypes.POINTER(ctypes.c_double)       #returns pointer to double
lib.normal.argtypes = [ctypes.POINTER(ctypes.c_double)]    #takes pointer to array

#defining point P as a list(array) to pass it as input to c function
P = (ctypes.c_double * 3)(1,2,-3)

#calling c function
n_ptr = lib.normal(P)  #storing the return value in n_ptr that points to memory location of [1,2,-3]

#extracting values into a python list using for loop
n = [n_ptr[i] for i in range(3)] 

#conveting to numpy for plotting

n = np.array(n)
point = np.array([1,2,-3])  #point P that lies on the plane

\end{lstlisting}
\end{frame}

% Python calling C
\begin{frame}[fragile]{Python: call\_c.py}
\begin{lstlisting}[language=Python]

#Plane equation
x = np.linspace(-10,10,100)
y = np.linspace(-10,10,100)

x,y = np.meshgrid(x,y)

d = n[0]*point[0] + n[1]*point[1] + n[2]*point[2]

z = (d - n[0]*x -n[1]*y)/n[2]

#plotting

fig = plt.figure(figsize=(8,6))

ax = fig.add_subplot(111,projection="3d")

ax.plot_surface(x,y,z,alpha=0.5,color='blue',edgecolor='none')

ax.scatter(*point,color='red',s=2,label="P(1,2,-3)")


#plotting normal vector OP 
ax.quiver(0,0,0,n[0],n[1],n[2],color='yellow', arrow_length_ratio=0.2,label="Normal Vector")

ax.set_xlabel("X Axis")
ax.set_ylabel("Y Axis")
ax.set_zlabel("Z Axis")
ax.set_title("Plane")
ax.legend()
ax.grid(True)

\end{lstlisting}
\end{frame}

% Python calling C
\begin{frame}[fragile]{Python: call\_c.py}
\begin{lstlisting}[language=Python]

plt.tight_layout()

#saving the figure in figs folder
fig.savefig(os.path.join(figs_folder,"plane.png"))

plt.show()

\end{lstlisting}
\end{frame}

%Only Python
\begin{frame}[fragile]{Python: plot.py}
\begin{lstlisting}[language=Python]

import numpy as np
import matplotlib.pyplot as plt
import os

#for generating figure in figs folder
figs_folder= os.path.join("..","figs")

#normal vector (same as returned by C code)
n = np.array([1,2,-3])
point = np.array([1,2,-3])  #point P that lies on the plane

#Plane equation
x = np.linspace(-10,10,100)
y = np.linspace(-10,10,100)

x,y = np.meshgrid(x,y)


d = n[0]*point[0] + n[1]*point[1] + n[2]*point[2]

z = (d - n[0]*x -n[1]*y)/n[2]

#plotting

fig = plt.figure(figsize=(8,6))

ax = fig.add_subplot(111,projection="3d")

ax.plot_surface(x,y,z,alpha=0.5,color='blue',edgecolor='none')

ax.scatter(*point,color='red',s=2,label="P(1,2,-3)")

\end{lstlisting}
\end{frame}

%Only Python
\begin{frame}[fragile]{Python: plot.py}
\begin{lstlisting}[language=Python]

#plotting normal vector OP 
ax.quiver(0,0,0,n[0],n[1],n[2],color='yellow', arrow_length_ratio=0.2,label="Normal Vector")

ax.set_xlabel("X Axis")
ax.set_ylabel("Y Axis")
ax.set_zlabel("Z Axis")
ax.set_title("Plane")
ax.legend()
ax.grid(True)

plt.tight_layout()

#saving the figure in figs folder
fig.savefig(os.path.join(figs_folder,"plane.png"))

plt.show()

\end{lstlisting}
\end{frame}

\end{document}
