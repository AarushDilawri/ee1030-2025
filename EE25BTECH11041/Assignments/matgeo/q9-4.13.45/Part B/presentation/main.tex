\documentclass{beamer}
\usepackage[utf8]{inputenc}

\usetheme{Madrid}
\usecolortheme{default}
\usepackage{amsmath,amssymb,amsfonts,amsthm}
\usepackage{txfonts}
\usepackage{tkz-euclide}
\usepackage{listings}
\usepackage{adjustbox}
\usepackage{array}
\usepackage{tabularx}
\usepackage{gvv}
\usepackage{lmodern}
\usepackage{circuitikz}
\usepackage{tikz}
\usepackage{graphicx}

\setbeamertemplate{page number in head/foot}[totalframenumber]

\usepackage{tcolorbox}
\tcbuselibrary{minted,breakable,xparse,skins}



\definecolor{bg}{gray}{0.95}
\DeclareTCBListing{mintedbox}{O{}m!O{}}{%
	breakable=true,
	listing engine=minted,
	listing only,
	minted language=#2,
	minted style=default,
	minted options={%
		linenos,
		gobble=0,
		breaklines=true,
		breakafter=,,
		fontsize=\small,
		numbersep=8pt,
		#1},
	boxsep=0pt,
	left skip=0pt,
	right skip=0pt,
	left=25pt,
	right=0pt,
	top=3pt,
	bottom=3pt,
	arc=5pt,
	leftrule=0pt,
	rightrule=0pt,
	bottomrule=2pt,
	toprule=2pt,
	colback=bg,
	colframe=orange!70,
	enhanced,
	overlay={%
		\begin{tcbclipinterior}
			\fill[orange!20!white] (frame.south west) rectangle ([xshift=20pt]frame.north west);
	\end{tcbclipinterior}},
	#3,
}
\lstset{
	language=C,
	basicstyle=\ttfamily\small,
	keywordstyle=\color{blue},
	stringstyle=\color{orange},
	commentstyle=\color{green!60!black},
	numbers=left,
	numberstyle=\tiny\color{gray},
	breaklines=true,
	showstringspaces=false,
}
\begin{document}

\title 
{4.13.45 }
\date{25 September,2025}

\author 
{Naman Kumar-EE25BTECH11041}
\graphicspath{./figs}


\frame{\titlepage}
\begin{frame}{Question b)}
Find the equation of the line which bisects the obtuse angle between the lines x - 2y + 4 = 0 and 4x - 3y + 2 = 0.
\end{frame}
\begin{frame}{Solution}
Given,
\input{tables/table.tex}
\begin{align}
\vec{n_1}^T\vec{x}=c_1,\vec{n_2}^T\vec{x}
\end{align}
\end{frame}
\begin{frame}{Solution}
Where,
\begin{align}
\vec{n_1}=\begin{pmatrix}1\\-2\end{pmatrix},\vec{n_2}=\begin{pmatrix}4\\-3\end{pmatrix},c_1=-4\text{ and }c_2=-2
\end{align}
Equation for bisectors is
\begin{align}
    \lvert\frac{\vec{n_1}^T\vec{B}-c_1}{\parallel\vec{n_1}\parallel}\rvert=\lvert\frac{\vec{n_2}^T\vec{B}-c_2}{\parallel\vec{n_2}\parallel}\rvert\\
    \frac{\vec{n_1}^T\vec{B}-c_1}{\parallel\vec{n_1}\parallel}=\pm \frac{\vec{n_2}^T\vec{B}-c_2}{\parallel\vec{n_2}\parallel}\\
    \frac{\vec{n_1}^T\vec{B_1}-c_1}{\parallel\vec{n_1}\parallel}=\frac{\vec{n_2}^T\vec{B_1}-c_2}{\parallel\vec{n_2}\parallel},\text{ and }\frac{\vec{n_1}^T\vec{B_2}-c_1}{\parallel\vec{n_1}\parallel}=-\frac{\vec{n_2}^T\vec{B_2}-c_2}{\parallel\vec{n_2}\parallel}
\end{align}
\end{frame}
\begin{frame}{Solution}
Can be written as
\begin{align}
    \brak{\frac{\vec{n_1}^T}{\parallel\vec{n_1}\parallel} - \frac{\vec{n_2}^T}{\parallel\vec{n_2}\parallel}}\vec{B_1}=\brak{\frac{c_1}{\parallel\vec{n_1}\parallel} - \frac{c_2}{\parallel\vec{n_2}\parallel}}\label{b1} \\
    \vec{n_{B_1}}^TB_1=c_{B_1} \label{b1}
\end{align}
and
\begin{align}
    \brak{\frac{\vec{n_1}^T}{\parallel\vec{n_1}\parallel} + \frac{\vec{n_2}^T}{\parallel\vec{n_2}\parallel}}\vec{B_2}=\brak{\frac{c_2}{\parallel\vec{n_2}\parallel} + \frac{c_1}{\parallel\vec{n_1}\parallel}} {b2}\\
    \vec{n_{B_2}}^TB_2=c_{B_2} \label{b2}
\end{align}
Now for obtuse angle bisector
\begin{align}
    \cos\theta_1=\frac{\vec{n_{B_1}}^T\vec{n_1}}{\parallel\vec{n_1}\parallel\parallel\vec{n_{B_1}}\parallel}\\
    \cos\theta_2=\frac{\vec{n_{B_2}}^T\vec{n_1}}{\parallel\vec{n_1}\parallel\parallel\vec{n_{B_2}}\parallel}
\end{align}
\end{frame}
\begin{frame}{Solution}
Solving with $\eqref{b1}$ and $\eqref{b2}$
\begin{align}
    \cos\theta_1=\frac{\brak{\frac{\vec{n_1}^T}{\parallel\vec{n_1}\parallel} - \frac{\vec{n_2}^T}{\parallel\vec{n_2}\parallel}}\vec{n_1}}{\parallel\vec{n_1}\parallel\parallel\vec{n_{B_1}}\parallel}\\
    \cos\theta_1=\frac{\brak{\frac{\vec{n_1}^T}{\parallel\vec{n_1}\parallel}\vec{n_1} - \frac{\vec{n_2}^T}{\parallel\vec{n_2}\parallel}\vec{n_1}}}{\parallel\vec{n_1}\parallel\parallel\vec{n_{B_1}}\parallel}\\
    \cos\theta_1=\frac{\brak{\sqrt{5} - \frac{10}{5}}}{\parallel\vec{n_1}\parallel\parallel\vec{n_{B_1}}\parallel}\\
    \cos\theta_1=\frac{\sqrt{5}-2}{\sqrt{5}\sqrt{\brak{\frac{1}{\sqrt{5}}-\frac{4}{5}}^2+\brak{\frac{3}{5}-\frac{2}{\sqrt{5}}}^2}}\approx 0.22 \label{a1}
\end{align}
\end{frame}
\begin{frame}{Solution}
Similarly
\begin{align}
    \cos\theta_2=\frac{\sqrt{5}+2}{\sqrt{5}\sqrt{\brak{\frac{1}{\sqrt{5}}+\frac{4}{5}}^2+\brak{\frac{3}{5}+\frac{2}{\sqrt{5}}}^2}}\approx 0.97\label{a2}
\end{align}
by comparing $\eqref{a1}$ and $\eqref{a2}$
\begin{align}
    \theta_1>\theta_2
\end{align}
\end{frame}
\begin{frame}{Solution}
So $B_1$ is obtuse angle bisector
\begin{align}
\vec{n_{B_1}}^TB_1=c_{B_1}\\
\vec{n_{\vec{B_1}}}= \begin{pmatrix}\frac{1}{\sqrt{5}}-\frac{4}{5}\\ \frac{3}{5}-\frac{2}{\sqrt{5}} \end{pmatrix}
\end{align}
and
\begin{align}
    c_{B_1}=\frac{2}{5}+\frac{-4}{\sqrt{5}}
\end{align}
\end{frame}
\begin{frame}{Figure}
    \begin{figure}
        \centering
        \includegraphics[width=0.7\columnwidth]{figs/figure.png}
        \caption{}
        \label{fig:placeholder}
    \end{figure}
\end{frame}
\begin{frame}[fragile]
\frametitle{C code}
\begin{lstlisting}
// main.c
// Compile with: gcc -shared -o libbisector.so -fPIC main.c -lm

#include <stdio.h>
#include <math.h>

typedef struct {
    double a;
    double b;
    double c;
} Line;

// helper: clamp for acos
static double clamp(double v, double lo, double hi){
    if(v < lo) return lo;
    if(v > hi) return hi;
    return v;
}
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{C code}
\begin{lstlisting}
// compute direction vector (dx,dy) for line ax+by+c=0
// direction vector = (b, -a)
static void dir_vector(double a, double b, double *dx, double *dy){
    *dx = b;
    *dy = -a;
}

// angle between directions (dx1,dy1) and (dx2,dy2) in [0, pi]
static double angle_between(double dx1, double dy1, double dx2, double dy2){
    double dot = dx1*dx2 + dy1*dy2;
    double n1 = sqrt(dx1*dx1 + dy1*dy1);
    double n2 = sqrt(dx2*dx2 + dy2*dy2);
    if(n1==0 || n2==0) return 0.0;
    double cosv = clamp(dot/(n1*n2), -1.0, 1.0);
    return acos(cosv);
}
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{C code}
\begin{lstlisting}
// Solve intersection of two lines. returns 1 if solvable, 0 if parallel.
static int intersect_point(double a1,double b1,double c1,double a2,double b2,double c2, double *x, double *y){
    double D = a1*b2 - a2*b1;
    if(fabs(D) < 1e-12) return 0;
    *x = (b1*c2 - b2*c1) / D;
    *y = (a2*c1 - a1*c2) / D;
    return 1;
}

// API: compute the obtuse-angle bisector line coefficients into result
Line obtuse_bisector(double a1, double b1, double c1, double a2, double b2, double c2){
    Line res = {0,0,0};
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{C code}
\begin{lstlisting}
    // normalization factors
    double s1 = sqrt(a1*a1 + b1*b1);
    double s2 = sqrt(a2*a2 + b2*b2);
    if(s1 == 0 || s2 == 0){
        return res;
    }

    // Build the two candidate bisector lines:
    // (+) => (a1/s1 - a2/s2) x + (b1/s1 - b2/s2) y + (c1/s1 - c2/s2) = 0
    // (-) => (a1/s1 + a2/s2) x + (b1/s1 + b2/s2) y + (c1/s1 + c2/s2) = 0
    Line Lplus, Lminus;
    Lplus.a =  a1/s1 - a2/s2;
    Lplus.b =  b1/s1 - b2/s2;
    Lplus.c =  c1/s1 - c2/s2;
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{C code}
\begin{lstlisting}
    Lminus.a =  a1/s1 + a2/s2;
    Lminus.b =  b1/s1 + b2/s2;
    Lminus.c =  c1/s1 + c2/s2;

    // We need to choose which of Lplus or Lminus is the bisector of the obtuse angle.
    // Strategy:
    //  - compute direction vectors of original lines and the two bisectors
    //  - compute the small angle between L1 and L2 (in [0, pi/2])
    //  - for each bisector compute its angle with L1 (in [0, pi])
    //  - the bisector corresponding to the obtuse angle will make an angle > pi/4 with L1
    // This numeric test is stable for non-degenerate cases.
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{C code}
\begin{lstlisting}
    double dx1, dy1;
    dir_vector(a1, b1, &dx1, &dy1);
    double dx2, dy2;
    dir_vector(a2, b2, &dx2, &dy2);

    double theta = angle_between(dx1, dy1, dx2, dy2);
    if(theta > M_PI_2) theta = M_PI - theta; // small angle in [0, pi/2]

    // bisector directions
    double dpx, dpy, dmx, dmy;
    dir_vector(Lplus.a, Lplus.b, &dpx, &dpy);
    dir_vector(Lminus.a, Lminus.b, &dmx, &dmy);

    double alpha_plus  = angle_between(dx1, dy1, dpx, dpy);
    double alpha_minus = angle_between(dx1, dy1, dmx, dmy);
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{C code}
\begin{lstlisting}
    // The bisector of the obtuse angle will have alpha > pi/4 (because obtuse half-angle > pi/4).
    if(alpha_plus > alpha_minus){
        // Choose plus if it gives larger angle
        res = Lplus;
    } else {
        res = Lminus;
    }
    // Optionally normalize so that sqrt(a^2+b^2)=1 and keep sign consistent
    double norm = sqrt(res.a*res.a + res.b*res.b);
    if(norm > 1e-12){
        res.a /= norm;
        res.b /= norm;
        res.c /= norm;
    }
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{C code}
\begin{lstlisting}
    // ensure consistent sign: make a >= 0 or if a==0 ensure b>=0
    if(res.a < -1e-12 || (fabs(res.a) < 1e-12 && res.b < -1e-12)){
        res.a = -res.a; res.b = -res.b; res.c = -res.c;
    }
    return res;
}
// If used from command line for quick test
#ifdef TEST_C
int main(){
    // Given example: x - 2y + 4 = 0  and 4x - 3y + 2 = 0
    double a1=1, b1=-2, c1=4;
    double a2=4, b2=-3, c2=2;
    Line obt = obtuse_bisector(a1,b1,c1,a2,b2,c2);
    printf("Obtuse bisector: %.6f x + %.6f y + %.6f = 0\n", obt.a, obt.b, obt.c);
    return 0;
}
#endif
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{Python code shared object}
\begin{lstlisting}
# main.py
# Usage:
# 1. Compile C: gcc -shared -o libbisector.so -fPIC main.c -lm
# 2. Run: python3 main.py

import ctypes
from ctypes import Structure, c_double
import numpy as np
import matplotlib.pyplot as plt
import math
import os

# define Line struct to match C
class Line(Structure):
    _fields_ = [("a", c_double), ("b", c_double), ("c", c_double)]
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{Python code shared object}
\begin{lstlisting}
# load shared library (adjust path if necessary)
libpath = "./libbisector.so"
if not os.path.exists(libpath):
    raise RuntimeError(f"Shared object {libpath} not found. Compile main.c first.")

lib = ctypes.CDLL(libpath)
lib.obtuse_bisector.restype = Line
lib.obtuse_bisector.argtypes = [c_double,c_double,c_double,c_double,c_double,c_double]

# Given lines
# L1: x - 2y + 4 = 0  => a1=1, b1=-2, c1=4
# L2: 4x - 3y + 2 = 0 => a2=4, b2=-3, c2=2
a1, b1, c1 = 1.0, -2.0, 4.0
a2, b2, c2 = 4.0, -3.0, 2.0
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{Python code shared object}
\begin{lstlisting}
# call C function
res = lib.obtuse_bisector(a1,b1,c1,a2,b2,c2)
A, B, C = res.a, res.b, res.c

# print equation in nicer form (scale back to readable)
# We'll scale so that coefficients are not tiny; find max abs
scale = max(abs(A), abs(B), abs(C))
if scale < 1e-12: scale = 1.0
A_s, B_s, C_s = A/scale, B/scale, C/scale

print("Computed (normalized) obtuse-angle bisector coefficients:")
print(f"A = {A:.6f}, B = {B:.6f}, C = {C:.6f}")
print(f"Equation: ({A_s:.6f}) x + ({B_s:.6f}) y + ({C_s:.6f}) = 0   (scaled)")
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{Python code shared object}
\begin{lstlisting}
# Compute intersection point of L1 and L2 for plotting center
D = a1*b2 - a2*b1
if abs(D) < 1e-12:
    print("Given lines are parallel or nearly parallel; cannot find intersection.")
    Px = Py = 0.0
else:
    Px = (b1*c2 - b2*c1) / D
    Py = (a2*c1 - a1*c2) / D
    print(f"Intersection point: P = ({Px:.6f}, {Py:.6f})")
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{Python code shared object}
\begin{lstlisting}
# Prepare plotting
# produce a range around intersection
rng = 10
xs = np.linspace(Px - rng, Px + rng, 400)

# function to produce y from ax+by+c=0 -> y = (-a x - c)/b if b!=0 else None
def line_y(a,b,c, xvals):
    if abs(b) < 1e-12:
        return None
    return [(-a*x - c)/b for x in xvals]
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{Python code shared object}
\begin{lstlisting}
y1 = line_y(a1,b1,c1, xs)
y2 = line_y(a2,b2,c2, xs)
yB = line_y(A,B,C, xs)

plt.figure(figsize=(8,8))
if y1 is not None:
    plt.plot(xs, y1, label="L1: x - 2y + 4 = 0", linewidth=2)
else:
    # vertical line x = -c/a
    xv = -c1/a1
    plt.axvline(x=xv, label="L1 (vertical)")
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{Python code shared object}
\begin{lstlisting}
if y2 is not None:
    plt.plot(xs, y2, label="L2: 4x - 3y + 2 = 0", linewidth=2)
else:
    xv = -c2/a2
    plt.axvline(x=xv, label="L2 (vertical)")

if yB is not None:
    plt.plot(xs, yB, '--', label="Obtuse-angle bisector", linewidth=2)
else:
    xv = -C/A
    plt.axvline(x=xv, linestyle='--', label="Obtuse bisector (vertical)")
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{Python code shared object}
\begin{lstlisting}
# plot intersection point
plt.scatter([Px],[Py], color='k')
plt.text(Px, Py, '  P(intersection)', fontsize=9)

plt.axhline(0, color='gray', linewidth=0.5)
plt.axvline(0, color='gray', linewidth=0.5)
plt.legend()
plt.grid(True)
plt.xlabel('x')
plt.ylabel('y')
plt.title('Lines and the Obtuse-angle Bisector')
plt.axis('equal')
plt.show()
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{Direct Python}
\begin{lstlisting}
import numpy as np
import matplotlib.pyplot as plt

plt.figure(figsize=(6,6), dpi=200)

x1= np.linspace(-6,6,100)
y1=(x1+4)/2

x2= np.linspace(-6,6,100)
y2=(4*x2+2)/3
\end{lstlisting}
\end{frame}
\begin{frame}[fragile]
\frametitle{Direct Python}
\begin{lstlisting}
bx=np.linspace(-6,6,100)
by=(1.39-0.35*bx)/0.29

plt.plot(x1,y1, color='orange', label="line 1")
plt.plot(x2,y2, color='blue', label="line 2")
plt.plot(bx,by,':', color='green', label="Bisector 1")
plt.legend()
plt.grid()
plt.savefig("figure.png", dpi=250)
plt.show()

\end{lstlisting}
\end{frame}
\end{document}