\documentclass{beamer}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}

\usetheme{Madrid}
\usecolortheme{default}
\usepackage{amsmath,amssymb,amsfonts,amsthm}
\usepackage{txfonts}
\usepackage{tkz-euclide}
\usepackage{listings}
\usepackage{adjustbox}
\usepackage{array}
\usepackage{tabularx}
\usepackage{gvv}
\usepackage{lmodern}
\usepackage{circuitikz}
\usepackage{tikz}
\usepackage{graphicx}
\usepackage{capt-of}

\setbeamertemplate{page number in head/foot}[totalframenumber]

\usepackage{tcolorbox}
\tcbuselibrary{minted,breakable,xparse,skins}

\definecolor{bg}{gray}{0.95}
\DeclareTCBListing{mintedbox}{O{}m!O{}}{%
  breakable=true,
  listing engine=minted,
  listing only,
  minted language=#2,
  minted style=default,
  minted options={%
    linenos,
    gobble=0,
    breaklines=true,
    breakafter=,,
    fontsize=\small,
    numbersep=8pt,
    #1},
  boxsep=0pt,
  left skip=0pt,
  right skip=0pt,
  left=25pt,
  right=0pt,
  top=3pt,
  bottom=3pt,
  arc=5pt,
  leftrule=0pt,
  rightrule=0pt,
  bottomrule=2pt,
  toprule=2pt,
  colback=bg,
  colframe=orange!70,
  enhanced,
  overlay={%
    \begin{tcbclipinterior}
    \fill[orange!20!white] (frame.south west) rectangle ([xshift=20pt]frame.north west);
    \end{tcbclipinterior}},
  #3,
}
\lstset{
    language=C,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue},
    stringstyle=\color{orange},
    commentstyle=\color{green!60!black},
    numbers=left,
    numberstyle=\tiny\color{gray},
    breaklines=true,
    showstringspaces=false,
}

\title{1.8.27}
\subtitle{Vector Geometry}
\author{EE25BTECH11010 - Arsh Dhoke}
\date{}

\begin{document}

\begin{frame}
\titlepage
\end{frame}

\begin{frame}{Question}
Find the equation of set of points $\vec{P}$ such that 

$\|\vec{A}-\vec{P}\|^2 + \|\vec{B}-\vec{P}\|^2 = 2k^2$,

where $\vec{A}(3,4,5)$ and $\vec{B}(-1,3,-7)$.
\end{frame}

\begin{frame}{Input Parameters}
The input parameters for the problem are given in the table below.
\input{tables/table.tex}
\end{frame}

\begin{frame}{Condition Setup}
Let 
\[
\vec{P} = \myvec{x \\ y \\ z}.
\]
The condition is
\begin{align}
\|\vec{A}-\vec{P}\|^2 + \|\vec{B}-\vec{P}\|^2 = 2k^2 \\
(\vec{P}-\vec{A})^T(\vec{P}-\vec{A}) + (\vec{P}-\vec{B})^T(\vec{P}-\vec{B}) &= 2k^2
\end{align}
\end{frame}

\begin{frame}{Expanding Terms}
\begin{align}
\myvec{x-3 & y-4 & z-5}\myvec{x-3\\y-4\\z-5}
+ 
\myvec{x+1 & y-3 & z+7}\myvec{x+1\\y-3\\z+7}
&= 2k^2
\end{align}

\begin{align}
(x-3)^2 + (y-4)^2 + (z-5)^2 + (x+1)^2 + (y-3)^2 + (z+7)^2 &= 2k^2
\end{align}
\end{frame}

\begin{frame}{Simplification}
\begin{align}
2x^2 + 2y^2 + 2z^2 - 4x - 14y + 4z + 109 &= 2k^2 \\
(x-1)^2 + \left(y-\tfrac{7}{2}\right)^2 + (z+1)^2 &= k^2 - \tfrac{161}{4}
\end{align}

\[
k^2 > \tfrac{161}{4}
\]
\end{frame}

\begin{frame}{Plot}
\centering
\includegraphics[height=0.6\textheight, keepaspectratio]{figs/fig1.png}
\captionof{figure}{Graph plotted for $k=10$ as example.}
\end{frame}

\begin{frame}[fragile]
    \frametitle{C Code}
\begin{lstlisting}
#include <stdio.h>
#include <math.h>

// Function to solve the locus equation for k=10
void solveSphere() {
    double k = 10.0;

    // Center of sphere (from derivation)
    double Cx = 1.0;
    double Cy = 7.0 / 2.0;  // 3.5
    double Cz = -1.0;

    // Radius squared (correct formula)
    double R2 = k * k - 161.0 / 4.0;  // 100 - 40.25 = 59.75

    if (R2 <= 0) {
        printf("For k = %.2f, no real sphere exists (radius^2 = %.2f)\n", k, R2);
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]
    \frametitle{C Code}
\begin{lstlisting}
        return;
    }

    double R = sqrt(R2);

    printf("Equation of the sphere:\n");
    printf("(x - %.2f)^2 + (y - %.2f)^2 + (z - %.2f)^2 = %.2f\n", 
           Cx, Cy, Cz, R * R);

    printf("Center: (%.2f, %.2f, %.2f)\n", Cx, Cy, Cz);
    printf("Radius: %.2f\n", R);
}

int main() {
    solveSphere();  // for k=10
    return 0;
}
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]
    \frametitle{Python Code}
\begin{lstlisting}
import sympy as sp
import numpy as np
import matplotlib.pyplot as plt

# Define variables
x, y, z, k = sp.symbols('x y z k', real=True)

# Define points
A = sp.Matrix([3, 4, 5])
B = sp.Matrix([-1, 3, -7])
P = sp.Matrix([x, y, z])

# Distances squared
PA2 = (P - A).dot(P - A)
PB2 = (P - B).dot(P - B)

# Equation condition
eq = sp.Eq(PA2 + PB2, 2*k**2)
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]
    \frametitle{Python Code}
\begin{lstlisting}
print("Expanded equation:")
print(sp.expand(eq))

# Simplify into standard sphere form
expr = sp.expand(PA2 + PB2 - 2*k**2)
expr = sp.simplify(expr)
print("\nSimplified expression = 0:")
print(expr)

# Complete the squares
sphere_eq = sp.together(sp.factor(expr))
print("\nEquation of locus (sphere):")
print(sphere_eq)
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]
    \frametitle{Python Code}
\begin{lstlisting}
# ---- Extract center and radius ----
center = sp.Matrix([1, sp.Rational(7,2), -1])
radius_sq = k**2 - sp.Rational(161,4)

print(f"\nCenter: {center}")
print(f"Radius^2: {radius_sq}")

# ---- Plot the sphere for k=10 ----
k_val = 10
R = float(sp.sqrt(radius_sq.subs(k, k_val)))

# Mesh grid
u = np.linspace(0, 2*np.pi, 100)
v = np.linspace(0, np.pi, 100)
X = float(center[0]) + R*np.outer(np.cos(u), np.sin(v))
Y = float(center[1]) + R*np.outer(np.sin(u), np.sin(v))
Z = float(center[2]) + R*np.outer(np.ones_like(u), np.cos(v))
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]
    \frametitle{Python Code}
\begin{lstlisting}
fig = plt.figure(figsize=(6,6))
ax = fig.add_subplot(111, projection='3d')

ax.plot_surface(X, Y, Z, alpha=0.5, edgecolor='k', linewidth=0.3)
ax.scatter([float(center[0])], [float(center[1])], [float(center[2])], s=50, label="Center")

ax.set_xlabel("X")
ax.set_ylabel("Y")
ax.set_zlabel("Z")
ax.set_title("Sphere locus: PA^2 + PB^2 = 2k^2 (k=10)")
ax.legend()

plt.savefig("figs/fig1.png")
plt.show()
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]
    \frametitle{Python+ C Code}
\begin{lstlisting}
import ctypes
import sympy as sp
import numpy as np
import matplotlib.pyplot as plt

# =======================
# Load C shared library
# =======================
lib = ctypes.CDLL("./code.so")

# Define argument and return types
lib.solveSphere.argtypes = [
    ctypes.POINTER(ctypes.c_double),
    ctypes.POINTER(ctypes.c_double),
    ctypes.POINTER(ctypes.c_double),
    ctypes.POINTER(ctypes.c_double)
]
lib.solveSphere.restype = None
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]
    \frametitle{Python+ C Code}
\begin{lstlisting}
# Prepare output variables
Cx = ctypes.c_double()
Cy = ctypes.c_double()
Cz = ctypes.c_double()
R  = ctypes.c_double()

# Call the C function (k=10 inside C)
lib.solveSphere(ctypes.byref(Cx), ctypes.byref(Cy), ctypes.byref(Cz), ctypes.byref(R))

# Extract results from C
cx, cy, cz, r = Cx.value, Cy.value, Cz.value, R.value

if r < 0:
    print("No real sphere exists for k=10")
    exit()
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]
    \frametitle{Python+ C Code}
\begin{lstlisting}
print(f"Equation of sphere (from C): (x - {cx:.2f})^2 + (y - {cy:.2f})^2 + (z - {cz:.2f})^2 = {r**2:.2f}")
print(f"Center: ({cx:.2f}, {cy:.2f}, {cz:.2f}), Radius: {r:.2f}")

# =======================
# Plotting (Matplotlib)
# =======================
u = np.linspace(0, 2*np.pi, 100)
v = np.linspace(0, np.pi, 100)
X = cx + r * np.outer(np.cos(u), np.sin(v))
Y = cy + r * np.outer(np.sin(u), np.sin(v))
Z = cz + r * np.outer(np.ones_like(u), np.cos(v))

fig = plt.figure(figsize=(6,6))
ax = fig.add_subplot(111, projection='3d')

ax.plot_surface(X, Y, Z, alpha=0.5, edgecolor='k', linewidth=0.3)
ax.scatter([cx], [cy], [cz], s=50, label="Center")

ax.set_xlabel("X")
ax.set_ylabel("Y")
ax.set_zlabel("Z")
ax.set_title("Sphere locus: PA^2 + PB^2 = 2k^2 (k=10, from C)")
ax.legend()

plt.savefig("figs/fig1.png")
plt.show()
\end{lstlisting}
\end{frame}

\end{document}
